# Отчёт по задаче предсказания цены автомобиля

## 1. Что было сделано
1. Провела EDA:
   - посмотрела распределения основных числовых признаков (year, km_driven, mileage, engine, max_power, seats)
   - изучила выбросы и асимметрию, проверила пропуски
   - посмотрела связи признаков с целевой переменной `selling_price`
2. Подготовила данные:
   - разделение на train/test
   - масштабирование числовых признаков
   - one-hot encoding для категориальных признаков
3. Обучила и сравнила модели:
   - базовая LinearRegression только на числовых признаках
   - LinearRegression, Lasso, ElasticNet на нормализованных признаках
   - Ridge-регрессия на полном признаковом пространстве (числовые + OHE категориальные) с подбором `alpha` через GridSearchCV
4. Выбрала лучшую модель (Ridge), сохранила пайплайн и артефакты в файл `car_price_artifacts.pkl` и сделала Streamlit-приложение:
   - режим EDA
   - режим «Предсказания»
   - режим «Веса модели»

## 2. Результаты (метрики + краткая интерпретация)
### 2.1. Базовая LinearRegression (только числовые признаки)
- R² train ≈ 0.59
- R² test ≈ 0.59
- Business metric ≈ 0.227
Модель объясняет около 59 % вариации цены, качество на train и test близкое, сильного переобучения нет, но и запас по улучшению большой.

### 2.2. Регуляризованные модели на нормализованных признаках
- Lasso и ElasticNet дали метрики на уровне базовой линейной регрессии:
  - R² test ≈ 0.57–0.59
  - бизнес-метрика до 0.241
- Lasso почти не занулила коэффициенты (регуляризация слабая), ElasticNet даже немного ухудшила R²

### 2.3. Ridge (финальная модель)
- Лучший `alpha` = 1, подобран по GridSearchCV (cv=10)
- R² train (Ridge) ≈ 0.78
- R² test (Ridge) ≈ 0.78
- Business metric (Ridge) ≈ 0.308
Ridge на полном признаковом пространстве даёт заметный прирост: R² на тесте вырос с ~0.59 до ~0.78, бизнес-метрика — с 0.227 до 0.308.

## 3. Что дало наибольший прирост качества
Наибольший вклад в улучшение качества внесли:
1. Добавление категориальных признаков через One-Hot Encoding (а не только числовые фичи)
2. Использование Ridge-регрессии с регуляризацией (`alpha = 1`) и подбором гиперпараметра по кросс-валидации
Именно комбинация «полное признаковое пространство + Ridge» дала скачок R² test примерно с 0.59 до 0.78 и рост  бизнес-метрики до 0.308.

## 4. Что сделать не удалось и почему
- Не получилось получить заметный выигрыш от Lasso и ElasticNet:
  - при разумных значениях `alpha` и `l1_ratio` модели либо почти повторяют линейную регрессию, либо начинают терять качество
  - количество признаков не очень большое, поэтому жесткой разреженности (много нулевых коэффициентов) от Lasso здесь почти нет
В целом все основные эксперименты (масштабирование, регуляризация, перебор по сетке) были проведены, но улучшения дали только расширение признаков и Ridge.

## 5. Оценка разработанного сервиса (Streamlit-приложение)
1. **Удобство использования**
   - Простое боковое меню с тремя режимами: EDA, Предсказания, Веса модели
   - В режиме предсказаний есть два варианта: загрузить CSV с объектами или ввести один объект вручную через поля формы
2. **Визуализация**
   - В EDA показываются первые строки датасета и гистограмма выбранного числового признака + описательная статистика
   - В режиме весов отображается таблица коэффициентов и горизонтальный бар-плот по важности признаков
3. **Ограничения и заметные проблемы**
   - Приложение не делает автоматический поиск выбросов и аномалий — это можно добавить в следующих версиях
   - Нет отдельной валидации формата загруженного CSV (ожидается тот же набор колонок, как при обучении)
4. **Планы по улучшению**
   - Добавить более наглядные визуализации: пары признаков против целевой переменной, boxplot по категориям
   - Реализовать проверку входных данных и информативные сообщения об ошибках при неверном формате
   - Добавить возможность сравнивать несколько моделей по метрикам прямо в интерфейсе

## Ссылка на приложение на Streamlit:
https://ml-car-price-app.streamlit.app/
